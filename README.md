# 🎬 视频屏保程序

一个简单易用的Windows视频屏保工具，支持在系统空闲时自动播放指定视频文件。

## ✨ 功能特点

- **🕐 自动触发**: 系统空闲指定时间后自动播放视频
- **🎥 全屏播放**: 支持全屏视频播放，循环播放
- **🔊 音效支持**: 可播放视频原有声音
- **⚡ 快速退出**: 任意鼠标或键盘操作立即退出
- **⚙️ 灵活配置**: 支持配置文件自定义设置
- **🖥️ 系统集成**: 可添加到开机启动项

## 📋 系统要求

- Windows 7/8/10/11 (64位)
- 支持 MP4 格式视频文件
- 至少 100MB 可用磁盘空间

## 🚀 快速开始

### 方式一：直接使用可执行文件

1. **下载程序**
   - 下载 `screensaver.exe` 和 `config.json`
   - 放在同一个文件夹中

2. **准备视频文件**
   - 将您的视频文件重命名为 `video.mp4`
   - 或修改 `config.json` 中的路径设置

3. **运行程序**
   - 双击 `screensaver.exe` 启动程序
   - 选择相应操作即可

### 方式二：Python源码运行

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行程序**
   ```bash
   python main.py
   ```

## ⚙️ 配置说明

### config.json 配置文件

```json
{
  "video_path": "video.mp4",
  "idle_minutes": 5
}
```

**配置项说明：**

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `video_path` | 字符串 | `"video.mp4"` | 视频文件路径（相对或绝对路径） |
| `idle_minutes` | 整数 | `5` | 系统空闲触发时间（分钟） |

**配置示例：**

```json
{
  "video_path": "C:/Videos/my_screensaver.mp4",
  "idle_minutes": 10
}
```

## 📖 使用指南

### 交互式模式

运行程序后会显示主菜单：

```
🎬 视频屏保程序
==================================================

请选择操作:
1. 启动屏保服务
2. 停止屏保服务
3. 查看状态
4. 重新加载配置
5. 立即播放测试
6. 退出程序
```

**菜单说明：**

1. **启动屏保服务** - 开始监听系统空闲状态
2. **停止屏保服务** - 停止监听
3. **查看状态** - 显示当前运行状态和配置信息
4. **重新加载配置** - 重新读取配置文件
5. **立即播放测试** - 立即播放视频测试
6. **退出程序** - 退出应用

### 命令行模式

```bash
# 后台服务模式（自动启动监听）
screensaver.exe --daemon

# 测试模式（立即播放视频）
screensaver.exe --test

# 指定配置文件
screensaver.exe --config my_config.json

# 查看帮助
screensaver.exe --help
```

### 开机启动设置

**方法一：手动设置**

1. 按 `Win + R`，输入 `shell:startup`
2. 将 `screensaver.exe` 的快捷方式复制到启动文件夹
3. 重启电脑，程序将自动启动

**方法二：任务计划程序**

1. 打开"任务计划程序"
2. 创建基本任务，设置为"计算机启动时"
3. 选择程序为 `screensaver.exe --daemon`

## 🔧 开发和构建

### 开发环境

```bash
# 克隆项目（如果有Git仓库）
git clone <repository_url>
cd screensaver

# 安装依赖
pip install -r requirements.txt

# 运行开发版本
python main.py
```

### 项目结构

```
screensaver/
├── main.py              # 主程序入口
├── screensaver.py       # 核心屏保逻辑
├── config_manager.py    # 配置文件管理
├── system_monitor.py    # 系统空闲监听
├── video_player.py      # 全屏视频播放器
├── build.py            # 打包脚本
├── config.json          # 配置文件
├── requirements.txt     # 依赖列表
└── README.md           # 说明文档
```

### 构建可执行文件

```bash
# 运行打包脚本
python build.py

# 或使用 PyInstaller 直接打包
pyinstaller --onefile --windowed main.py
```

## 🎯 使用场景

### 个人用户

- **工作间隙**: 设置工作相关的激励视频
- **家庭娱乐**: 播放家庭照片制作的幻灯片视频
- **艺术展示**: 展示喜欢的艺术作品或风景视频

### 商业环境

- **店铺展示**: 播放产品宣传视频
- **展览会议**: 无人操作时播放介绍视频
- **数字标牌**: 作为简单的数字显示屏使用

## ❓ 常见问题

### Q: 视频文件不播放怎么办？

**A:** 检查以下几点：
1. 确认视频文件路径正确
2. 确认视频格式为 MP4
3. 确认视频文件没有损坏
4. 查看程序输出的错误信息

### Q: 如何调整空闲时间？

**A:** 修改 `config.json` 文件中的 `idle_minutes` 值，然后：
- 重启程序，或
- 在程序中选择"重新加载配置"

### Q: 如何更换视频文件？

**A:** 有两种方式：
1. 将新视频重命名为当前配置的文件名
2. 修改 `config.json` 中的 `video_path` 设置

### Q: 程序可以后台运行吗？

**A:** 可以，使用命令：
```bash
screensaver.exe --daemon
```

### Q: 如何完全退出程序？

**A:** 
- 交互模式：选择菜单中的"退出程序"
- 后台模式：按 `Ctrl+C` 或通过任务管理器结束进程
- 视频播放时：任意鼠标或键盘操作退出播放

## 🐛 故障排除

### 常见错误

1. **"视频文件不存在"**
   - 检查文件路径是否正确
   - 确认文件确实存在

2. **"获取系统空闲时间失败"**
   - 确认在Windows系统上运行
   - 以管理员权限运行程序

3. **"媒体播放错误"**
   - 检查视频文件格式
   - 尝试使用其他视频文件

### 日志和调试

程序运行时会在控制台输出详细信息，包括：
- 配置加载状态
- 系统空闲时间
- 视频播放状态
- 错误信息

如果遇到问题，请查看这些输出信息以定位问题。

## 📜 版本历史

### v1.0.0 (当前版本)
- ✅ 基本的视频播放功能
- ✅ 系统空闲时间监听
- ✅ 配置文件支持
- ✅ 全屏播放和用户输入检测
- ✅ 交互式和命令行模式

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目采用 MIT 许可证。

---

**技术支持**: 如果您在使用过程中遇到问题，请查看本文档的"常见问题"和"故障排除"部分。 